<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>{% block title %}gaithub{% endblock %}</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>

  <body>
    <div class="topbar">
      <div class="brand"><a href="/">gaithub</a></div>
      <div class="nav">
        <a href="/repos">repos</a>
      </div>
    </div>

    <div class="container">
      {% block content %}{% endblock %}

      {% if dev_show %}
        <div class="muted" style="margin-top:20px; font-size:12px;">
          DATA_DIR: {{ dev_data_dir }}
        </div>
      {% endif %}
    </div>

    <script>
      async function copyText(id) {
        const el = document.getElementById(id);
        const text = (el && (el.value || el.innerText || el.textContent) || "").trim();

        if (!text) {
          alert("Nothing to copy.");
          return;
        }

        // Preferred API (secure contexts)
        try {
          if (navigator.clipboard && window.isSecureContext) {
            await navigator.clipboard.writeText(text);
            toast("Copied!");
            return;
          }
        } catch (err) {
          // Fall through to legacy method
          console.warn("Clipboard API failed, using fallback:", err);
        }

        // Fallback method (works on more browsers/contexts)
        try {
          const ta = document.createElement("textarea");
          ta.value = text;
          ta.setAttribute("readonly", "");
          ta.style.position = "fixed";
          ta.style.top = "-1000px";
          ta.style.left = "-1000px";
          document.body.appendChild(ta);
          ta.select();
          ta.setSelectionRange(0, ta.value.length);

          const ok = document.execCommand("copy");
          document.body.removeChild(ta);

          if (ok) toast("Copied!");
          else alert("Copy failed. Select and copy manually.");
        } catch (err) {
          console.error("Fallback copy failed:", err);
          alert("Copy failed. Select and copy manually.");
        }
      }

      function toast(msg) {
        // Minimal feedback without needing extra CSS
        const t = document.createElement("div");
        t.textContent = msg;
        t.style.position = "fixed";
        t.style.bottom = "16px";
        t.style.right = "16px";
        t.style.padding = "10px 12px";
        t.style.border = "1px solid #202938";
        t.style.background = "#0f1623";
        t.style.color = "#e6edf3";
        t.style.borderRadius = "10px";
        t.style.zIndex = "9999";
        document.body.appendChild(t);
        setTimeout(() => t.remove(), 900);
      }
    </script>
  </body>
</html>
